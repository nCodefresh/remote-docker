version: '1.0'

steps:

  build_image:
    type: build
    title: Build remote-docker image 
    dockerfile: Dockerfile
    working-directory: ${{main_clone}}
    image-name: ncodefresh/remote-docker
    build_arguments:
      - GH_SHA=${{CF_REVISION}}

  push_to_registry:
    type: push
    title: Pushing master to DockerHub
    registry: dockerhub
    candidate: '${{build_image}}'
    tag: '${{CF_BRANCH}}'

#  tag_branch_registry:
#    type: push
#    title: Pushing ${{CF_BRANCH}} to DockerHub
#    candidate: '${{build_image}}'
#    tag: ${{CF_BRANCH}}